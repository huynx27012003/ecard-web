<div class="sidebar" id="sidebar">
    <div class="sidebar-inner slimscroll">
        <div id="sidebar-menu" class="sidebar-menu">
            <ul>
                <li class="menu-title">
                    <span>Menu chính</span>
                </li>

                <!-- Dashboard -->
                <li>
                    <a href="/index"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a>
                </li>

                <!-- Design Card - Available for all users -->
                <li>
                    <a href="/create-card"><i class="fas fa-paint-brush"></i> <span>Tạo Danh Thiếp</span></a>
                </li>

                <!-- My Card -->
                <li>
                    <a href="/my-card"><i class="fas fa-id-card"></i> <span>Danh Thiếp Của Tôi</span></a>
                </li>

                <% if (loggedInUser && (loggedInUser.role==='admin' || loggedInUser.role==='ceo' ||
                    loggedInUser.username==='huynx' )) { %>

                    <li class="menu-title">
                        <span>Quản lý</span>
                    </li>

                    <% if (loggedInUser.role==='admin' || loggedInUser.username==='huynx' ) { %>
                        <!-- User Management - Admin only - Direct link -->
                        <li>
                            <a href="/user"><i class="fas fa-users"></i> <span>Quản lý người dùng</span></a>
                        </li>
                        <% } %>

                            <!-- Company/Employee Management -->
                            <li>
                                <a href="/employee-list"><i class="fas fa-user-tie"></i> <span>Danh sách nhân
                                        viên</span></a>
                            </li>

                            <% if (loggedInUser.role==='admin' || loggedInUser.username==='huynx' ) { %>
                                <li>
                                    <a href="/companies-list"><i class="fas fa-building"></i> <span>Quản lý công
                                            ty</span></a>
                                </li>

                                <!-- Subscription - Admin only -->
                                <li>
                                    <a href="/subscription"><i class="fas fa-credit-card"></i> <span>Gói dịch
                                            vụ</span></a>
                                </li>
                                <% } %>

                                    <% } %>

                                        <li class="menu-title">
                                            <span>Tài khoản</span>
                                        </li>

                                        <li>
                                            <a href="/logout"><i class="fas fa-sign-out-alt"></i> <span>Đăng
                                                    xuất</span></a>
                                        </li>
            </ul>
        </div>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            © 2025 AT Energy JSC
        </div>
    </div>
</div>

<style>
    /* Sidebar Styling */
    .sidebar {
        background: #1a1a2e;
        width: 240px;
        position: fixed;
        top: 60px;
        left: 0;
        bottom: 0;
        z-index: 99;
        transition: all 0.3s ease;
        overflow-y: auto;
    }

    .sidebar-inner {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .sidebar-menu {
        flex: 1;
        padding: 20px 0;
    }

    .sidebar-footer {
        padding: 16px 20px;
        font-size: 11px;
        color: #6b7280;
        text-align: center;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .mini-sidebar .sidebar-footer {
        font-size: 9px;
        padding: 12px 8px;
    }

    .sidebar-menu ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .sidebar-menu .menu-title {
        padding: 12px 20px 8px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #6b7280;
    }

    .sidebar-menu>ul>li>a {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        color: #9ca3af;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.2s ease;
        border-left: 3px solid transparent;
    }

    .sidebar-menu>ul>li>a:hover,
    .sidebar-menu>ul>li>a.active {
        background: rgba(1, 37, 150, 0.15);
        color: #fff;
        border-left-color: #012596;
    }

    .sidebar-menu>ul>li>a i {
        width: 20px;
        margin-right: 12px;
        font-size: 16px;
    }

    /* Mobile Sidebar - Slide in from left */
    @media (max-width: 991px) {
        .sidebar {
            left: -240px;
        }

        .sidebar.active {
            left: 0;
        }
    }

    /* Mini Sidebar for Desktop */
    .mini-sidebar .sidebar {
        width: 70px;
    }

    .mini-sidebar .sidebar-menu>ul>li>a span {
        display: none;
    }

    .mini-sidebar .sidebar-menu>ul>li>a i {
        margin-right: 0;
        font-size: 18px;
    }

    .mini-sidebar .sidebar-menu .menu-title {
        display: none;
    }

    .mini-sidebar .sidebar-menu>ul>li>a {
        justify-content: center;
        padding: 14px 20px;
    }

    /* Tooltip for mini sidebar */
    .mini-sidebar .sidebar-menu>ul>li {
        position: relative;
    }

    .mini-sidebar .sidebar-menu>ul>li>a:hover::after {
        content: attr(data-title);
        position: absolute;
        left: 75px;
        top: 50%;
        transform: translateY(-50%);
        background: #1a1a2e;
        color: #fff;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 13px;
        white-space: nowrap;
        z-index: 100;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Highlight current page
        const currentPath = window.location.pathname;
        const menuLinks = document.querySelectorAll('.sidebar-menu > ul > li > a');

        menuLinks.forEach(function (link) {
            const href = link.getAttribute('href');
            if (href === currentPath || (currentPath.includes(href) && href !== '/index' && href !== '/')) {
                link.classList.add('active');
            }

            // Add data-title for tooltip in mini-sidebar mode
            const span = link.querySelector('span');
            if (span) {
                link.setAttribute('data-title', span.textContent);
            }
        });
    });
</script>